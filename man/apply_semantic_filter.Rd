% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/semantic_filter.R
\name{apply_semantic_filter}
\alias{apply_semantic_filter}
\title{Apply semantic filter to patient data}
\usage{
apply_semantic_filter(natural_query, patid, db_conn, db_type = "mssql")
}
\arguments{
\item{natural_query}{User's natural language query (e.g., "Show statins",
"Show encounters with A1c > 9")}

\item{patid}{Patient ID to filter by}

\item{db_conn}{Database connection from \code{\link{get_db_connections}}}

\item{db_type}{Database type: "mssql" or "duckdb"}
}
\value{
List with components:
\describe{
\item{filtered_data}{Data frame with matching records (or NULL on error)}
\item{sql}{Generated SQL query}
\item{error}{Error message (or NULL on success)}
\item{message}{Success message with record count}
}
}
\description{
Use natural language to filter patient data using AI-generated SQL.
Requires the ANTHROPIC_API_KEY environment variable to be set.
}
\examples{
\dontrun{
conns <- get_db_connections()
result <- apply_semantic_filter(
  "Show diagnoses containing diabetes",
  "PAT0000001",
  conns$cdw,
  conns$db_type
)
if (is.null(result$error)) {
  print(result$filtered_data)
}
}

}
